2. Lista Ordinata delle Classi da Implementare
Livello base (ENTITIES)
RootCA

Generazione e gestione chiavi root
Firma certificati subordinate (EA, AA)
Pubblicazione CRL
Firma messaggi CTL, link certificate
EnrollmentAuthority (EA)

Ricezione CSR da ITS-S
Validazione identità e proof of possession
Emissione Enrollment Certificate (EC)
Gestione revoca EC, pubblicazione CRL
AuthorizationAuthority (AA)

Ricezione richieste AT (standard/butterfly)
Validazione EC tramite EA
Emissione AT standard e batch AT butterfly
Gestione revoca AT, pubblicazione CRL
TrustListManager (TLM)

Gestione CTL (full/delta)
Pubblicazione LinkCertificate per root/EA/AA
Distribuzione trust anchors
ITSStation

Generazione chiavi ECC proprie
Richiesta EC a EA
Richiesta AT a AA (standard+butterfly)
Aggiornamento trust anchors (CTL/Delta)
Invio/ricezione messaggi firmati
Livello protocollo/messaggistica (PROTOCOL)
ETSIMessageEncoder

Serializzazione ASN.1 OER dei messaggi (CSR, EC, AT, CRL, CTL)
Parsing ASN.1 OER dei messaggi ricevuti
ETSIMessageTypes

Definizione strutture dati per tutti i messaggi ETSI TS 102941 (EnrollmentRequest, AuthorizationRequest, ButterflyRequest, ecc.)
Livello crittografia e sicurezza (CRYPTO)
CryptoManager
Generazione chiavi ECC (secp256r1, brainpool256r1)
Firma/verifica
AES-CCM per messaggi cifrati
Generazione HashedId8
Butterfly key expansion (se non disponibile da libreria)
Livello storage
FileSystemManager
Lettura/scrittura file ASN.1 OER
Gestione directory per ogni entità
Rotazione e cleanup batch AT, EC scaduti
Livello REST API
FlaskAppFactory
Inizializzazione Flask app con blueprint per ogni entità
Gestione routing endpoint REST
Implementazione autenticazione (API key/mTLS per endpoint inter-authority)
Livello revoca
CRLManager
Generazione Delta CRL
Pubblicazione/fetch CRL
Verifica revoca EC/AT
Livello test e supporto
TestScenarioManager
Simulazione end-to-end: Enrollment → Authorization → Message exchange
Simulazione revoca, rinnovo, download batch butterfly
(opzionale) Logging scenario
Livello configurazione
ConfigLoader
Lettura parametri da file di configurazione
Setup iniziale root/EA/AA
3. Roadmap Step-by-Step (Suggerita)
Step 1:
Implementa le entità base (RootCA, EA, AA, ITSStation) con generazione chiavi e gestione certificati.

Step 2:
Implementa la messaggistica ETSI ASN.1 OER con ETMessageEncoder/Types.

Step 3:
Implementa la logica REST API con FlaskAppFactory e autenticazione tra autorità.

Step 4:
Implementa la gestione storage su filesystem con FileSystemManager.

Step 5:
Implementa la gestione revoca con CRLManager e Delta CRL.

Step 6:
Implementa la generazione batch AT butterfly (con CryptoManager).

Step 7:
Implementa TLM e gestione CTL/link certificate.

Step 8:
Implementa i test end-to-end e cleanup automatico (TestScenarioManager).

